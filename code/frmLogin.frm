VERSION 5.00
Object = "{93AA248C-8E0E-4697-879F-8A6D0D6838E8}#1.0#0"; "lvButton_H.ocx"
Begin VB.Form frmLogin 
   BackColor       =   &H00F5F0D1&
   BorderStyle     =   0  'None
   Caption         =   "Login"
   ClientHeight    =   3420
   ClientLeft      =   2790
   ClientTop       =   3045
   ClientWidth     =   6270
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MDIChild        =   -1  'True
   MinButton       =   0   'False
   ScaleHeight     =   2020.649
   ScaleMode       =   0  'User
   ScaleWidth      =   5887.189
   ShowInTaskbar   =   0   'False
   Begin VB.Frame Frame2 
      BackColor       =   &H00C29E21&
      Height          =   735
      Left            =   120
      TabIndex        =   5
      Top             =   2520
      Width           =   6015
      Begin VB.CommandButton cmdOk1 
         BackColor       =   &H00E0E0E0&
         Caption         =   "&OK"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   390
         Left            =   6000
         Style           =   1  'Graphical
         TabIndex        =   7
         Top             =   240
         Width           =   1380
      End
      Begin VB.CommandButton cmdCancel1 
         BackColor       =   &H00E0E0E0&
         Caption         =   "C&ancel"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   390
         Left            =   6000
         Style           =   1  'Graphical
         TabIndex        =   6
         Top             =   360
         Width           =   1380
      End
      Begin lvButton_H.lvButtons_H cmdOk 
         Height          =   375
         Left            =   1080
         TabIndex        =   9
         Top             =   240
         Width           =   1815
         _ExtentX        =   3201
         _ExtentY        =   661
         Caption         =   "&Ok"
         CapAlign        =   2
         BackStyle       =   2
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         cBhover         =   14737632
         LockHover       =   1
         cGradient       =   0
         CapStyle        =   1
         Mode            =   0
         Value           =   0   'False
         Image           =   "frmLogin.frx":0000
         cBack           =   -2147483633
      End
      Begin lvButton_H.lvButtons_H cmdCancel 
         Height          =   375
         Left            =   3000
         TabIndex        =   10
         Top             =   240
         Width           =   1815
         _ExtentX        =   3201
         _ExtentY        =   661
         Caption         =   "&Cancel"
         CapAlign        =   2
         BackStyle       =   2
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         cBhover         =   14737632
         LockHover       =   1
         cGradient       =   16576
         CapStyle        =   1
         Mode            =   0
         Value           =   0   'False
         Image           =   "frmLogin.frx":0E82
         cBack           =   -2147483633
      End
   End
   Begin VB.Frame Frame1 
      BackColor       =   &H00C29E21&
      Height          =   2295
      Left            =   120
      TabIndex        =   0
      Top             =   120
      Width           =   6015
      Begin VB.TextBox txtPassword 
         Appearance      =   0  'Flat
         BackColor       =   &H00F5F0D1&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   345
         IMEMode         =   3  'DISABLE
         Left            =   1440
         PasswordChar    =   "*"
         TabIndex        =   2
         Top             =   1440
         Width           =   3645
      End
      Begin VB.TextBox txtUserName 
         Appearance      =   0  'Flat
         BackColor       =   &H00F5F0D1&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   345
         Left            =   1440
         TabIndex        =   1
         Top             =   840
         Width           =   3645
      End
      Begin VB.Label Label3 
         BackColor       =   &H00C29E21&
         Caption         =   "ENTER USERID AND PASSWORD TO LOG IN"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FFFFFF&
         Height          =   495
         Left            =   240
         TabIndex        =   8
         Top             =   240
         Width           =   5535
      End
      Begin VB.Label Label2 
         BackColor       =   &H00C29E21&
         Caption         =   "Password:"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FFFFFF&
         Height          =   375
         Left            =   240
         TabIndex        =   4
         Top             =   1440
         Width           =   1095
      End
      Begin VB.Label Label1 
         BackColor       =   &H00C29E21&
         Caption         =   "UserID:"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FFFFFF&
         Height          =   255
         Left            =   600
         TabIndex        =   3
         Top             =   840
         Width           =   855
      End
   End
End
Attribute VB_Name = "frmLogin"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Dim cn As New ADODB.Connection, rs As New ADODB.Recordset
Dim bFlag As Boolean, strg As String, List_Item As ListItem, Productid As String
Dim sflag As Boolean, ListProductID As String, ctrl As Control
Public LoginSucceeded As Boolean

Private Sub cmdCancel_Click()
frmLogout.Show
Me.Hide
  
End Sub

Private Sub cmdOk_Click()
If Trim(Me.txtUserName) = "" Then
   MsgBox "You Must Enter UserName.", vbInformation, "UserName"
   Me.txtUserName.SetFocus: Exit Sub
End If
If Trim(Me.txtPassword) = "" Then
   MsgBox "You Must Enter Password.", vbInformation, "Password"
   Me.txtPassword.SetFocus: Exit Sub
End If
On Error GoTo SaveError
If Trim(Me.txtUserName) = "NXOMEN" And Trim(Me.txtPassword) = "NAPOROW" Then
     Unload Me
     frmMDI.mnufile.Enabled = True
     frmMDI.mnuRetail.Enabled = True
     frmMDI.mnureports.Enabled = True
     frmMDI.mnuWholeSale.Enabled = True
     frmMDI.mnuWholeSaleReports.Enabled = True
     frmMDI.mnuManagement.Enabled = True
     frmMDI.mnuManagementReports.Enabled = True
'     frmMDI.mnuMaintain.Enabled = True
'     frmMDI.mnuCashRegister.Enabled = True
     frmMDI.mnuSetUps.Enabled = True
     frmMDI.mnuAccounts.Enabled = True
     frmHelp.Show
 Exit Sub
 End If
 

'Open Connecttion to Server
bFlag = OpenConnection(cn, strg)

If bFlag = False Then
   If cn.State = 1 Then cn.Close
   If rs.State = 1 Then rs.Close
   Me.MousePointer = vbDefault
  
   MsgBox strg, vbInformation:
   Exit Sub
End If

rs.Open "Select * from Users Where UserID ='" & txtUserName & "' And UserPassword ='" & txtPassword & "'", cn, adOpenKeyset, adLockOptimistic
If rs.RecordCount > 0 Then
  If rs.Fields("StatusOfAccount") = "UNBLOCKED" And rs.Fields("AccessLevel") = "MANAGER" Then
     frmMDI.txtU = rs.Fields("UserNo")
     'frmSellOut.txtUser.Text = rs.Fields("UserName")
     Unload Me
     frmMDI.mnufile.Enabled = True
     frmMDI.mnuRetail.Enabled = True
     frmMDI.mnureports.Enabled = True
     frmMDI.mnuWholeSale.Enabled = True
     frmMDI.mnuWholeSaleReports.Enabled = True
     frmMDI.mnuManagement.Enabled = False
     frmMDI.mnuManagementReports.Enabled = False
'     frmMDI.mnuMaintain.Enabled = True
'     frmMDI.mnuCashRegister.Enabled = True
     frmMDI.mnuSetUps.Enabled = True
     frmMDI.mnuAccounts.Enabled = True
     frmHelp.Show
'     frmDebtorsChequeDate.Show
     
  ElseIf rs.Fields("StatusOfAccount") = "UNBLOCKED" And rs.Fields("AccessLevel") = "DIRECTOR" Then
     frmMDI.txtU = rs.Fields("UserNo")
     'frmSellOut.txtUser.Text = rs.Fields("UserName")
     Unload Me
     frmMDI.mnufile.Enabled = True
     frmMDI.mnuRetail.Enabled = True
     frmMDI.mnureports.Enabled = True
     frmMDI.mnuWholeSale.Enabled = True
     frmMDI.mnuWholeSaleReports.Enabled = True
     frmMDI.mnuManagement.Enabled = True
     frmMDI.mnuManagementReports.Enabled = True
'     frmMDI.mnuMaintain.Enabled = True
'     frmMDI.mnuCashRegister.Enabled = True
     frmMDI.mnuSetUps.Enabled = True
     frmMDI.mnuAccounts.Enabled = True
     frmHelp.Show
'     frmDebtorsChequeDate.Show
     
   ElseIf rs.Fields("StatusOfAccount") = "UNBLOCKED" And rs.Fields("AccessLevel") = "ACCOUNTS" Then
     frmMDI.txtU = rs.Fields("UserNo")
     'frmSellOut.txtUser.Text = rs.Fields("UserName")
     Unload Me
     frmMDI.mnufile.Enabled = False
     frmMDI.mnuRetail.Enabled = False
     frmMDI.mnureports.Enabled = False
     frmMDI.mnuWholeSale.Enabled = False
     frmMDI.mnuWholeSaleReports.Enabled = False
     frmMDI.mnuManagement.Enabled = False
     frmMDI.mnuManagementReports.Enabled = False
'     frmMDI.mnuMaintain.Enabled = True
'     frmMDI.mnuCashRegister.Enabled = True
     frmMDI.mnuSetUps.Enabled = False
     frmMDI.mnuAccounts.Enabled = True
     frmHelp.Show
    
     
  ElseIf rs.Fields("StatusOfAccount") = "UNBLOCKED" And rs.Fields("AccessLevel") = "WHOLESALE" Then
     frmMDI.txtU = rs.Fields("UserNo")
     'frmSellOut.txtUser.Text = rs.Fields("UserName")
     Unload Me
     frmMDI.mnufile.Enabled = True
     frmMDI.mnuRetail.Enabled = True
     frmMDI.mnuChangePassword.Enabled = True
     frmMDI.mnuSellOut.Enabled = False
'     frmMDI.mnuSetProducts.Enabled = False
     frmMDI.mnureports.Enabled = False
     frmMDI.mnuWholeSale.Enabled = True
     frmMDI.mnuWholeSaleReports.Enabled = True
     frmMDI.mnuManagement.Enabled = False
     frmMDI.mnuManagementReports.Enabled = False
     frmHelp.cmdSetProducts.Enabled = False
     frmHelp.cmdProductsRpt.Enabled = False
     'frmMDI.mnuProductsReport = False
'     frmMDI.mnuMaintain.Enabled = Falseter.Enabled = False
     frmHelp.Show
     frmHelp.cmdSellout.Enabled = False
     frmHelp.cmdSales.Enabled = False
'     frmHelp.cmdCashRegister.Enabled = False
     
     
     
  ElseIf rs.Fields("StatusOfAccount") = "UNBLOCKED" And rs.Fields("AccessLevel") = "RETAIL" Then
     frmMDI.txtU = rs.Fields("UserNo")
     'frmSellOut.txtUser.Text = rs.Fields("UserName")
     Unload Me
      frmMDI.mnufile.Enabled = True
     frmMDI.mnuRetail.Enabled = True
     frmMDI.mnusales.Enabled = False
     frmMDI.mnuChangePassword.Enabled = True
     frmMDI.mnuSellOut.Enabled = True
'     frmMDI.mnuSetProducts.Enabled = False
     frmMDI.mnureports.Enabled = True
     frmMDI.mnurecievals.Enabled = False
     frmMDI.mnuWholeSale.Enabled = False
     frmMDI.mnuWholeSaleReports.Enabled = False
     frmMDI.mnuManagement.Enabled = False
     frmMDI.mnuManagementReports.Enabled = False
'     frmMDI.mnuCashRegister.Enabled = True
     'frmMDI.mnuProductsReport = False
'     frmMDI.mnuMaintain.Enabled = False
     frmHelp.Show
     frmHelp.cmdSetProducts.Enabled = False
     frmHelp.cmdProductsRpt.Enabled = False
     frmHelp.cmdSellout.Enabled = True
     frmHelp.cmdSales.Enabled = False
'     frmHelp.cmdCashRegister.Enabled = True
     
  ElseIf rs.Fields("StatusOfAccount") = "BLOCKED" Then
   MsgBox "Sorry, Your Accounts is Currently Blocked - You Cannot Access the System.", vbInformation, "System Access Denied"
   Me.txtUserName.SetFocus
  End If
  
'  Else
'    MsgBox "Incorrect User Name And/Or Password", vbInformation, "Enter The Correct User Name And/Or Password"
'    Me.txtUserName.SetFocus
'  End If
Else
   MsgBox "Incorrect User Name And/Or Password", vbInformation, "Enter The Correct User Name And/Or Password"
    Me.txtUserName.SetFocus
End If
   If cn.State = 1 Then cn.Close
   If rs.State = 1 Then rs.Close
   
   Exit Sub
SaveError:
        If cn.State = 1 Then cn.Close
        MsgBox "SORRY,UNABLE TO LOGIN :PLEASE TRY AGAIN!", vbInformation, "TRY AGAIN"
        Exit Sub
End Sub


Private Sub Form_Load()
CenterForm Me
Me.Height = 3420
Me.Width = 6270

End Sub

Private Sub txtPassword_KeyPress(KeyAscii As Integer)
Dim strk1 As String
If Chr(KeyAscii) >= "A" And Chr(KeyAscii) <= "Z" Then Exit Sub
If Chr(KeyAscii) >= "a" And Chr(KeyAscii) <= "z" Then
   KeyAscii = KeyAscii - 32
   Exit Sub
End If
strk1 = "0123456789/|\;:.,()"
If KeyAscii = vbKeyReturn Then
   Me.cmdOk.SetFocus
End If
If KeyAscii > 26 Then
   If KeyAscii <> 32 Then
      If InStr(1, strk1, Chr(KeyAscii)) = 0 Then
         KeyAscii = 0
      End If
   End If
End If
End Sub

Private Sub txtUserName_KeyPress(KeyAscii As Integer)
Dim strk1 As String
If Chr(KeyAscii) >= "A" And Chr(KeyAscii) <= "Z" Then Exit Sub
If Chr(KeyAscii) >= "a" And Chr(KeyAscii) <= "z" Then
   KeyAscii = KeyAscii - 32
   Exit Sub
End If
strk1 = "0123456789/|\;:.,()"
If KeyAscii = vbKeyReturn Then
   Me.txtPassword.SetFocus
End If
If KeyAscii > 26 Then
   If KeyAscii <> 32 Then
      If InStr(1, strk1, Chr(KeyAscii)) = 0 Then
         KeyAscii = 0
      End If
   End If
End If
End Sub




























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































